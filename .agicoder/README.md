# AGIcoder — каталог конфигурации (.agicoder/)

Этот каталог — единственный источник правды (Single Source of Truth) для агентов, промптов, инструментов и систем автоконтекста. Любые дефолтные данные расширения собираются напрямую из содержимого этой папки и упаковываются в `assets/agicoder-seed.zip` при сборке.

## Структура
- `agents/<agent>/agent.json`: описание агента
  - `visibleAgents`: список слугов агентов, которым разрешена делегация
  - `promptBindings`: включённые категории/варианты промптов
  - `toolBindings`: включённые группы/исключения инструментов
    - `customConfiguration.toolProfiles.*`: профили инструментов (например, дешёвая суммаризация)
  - `profiles`: привязка AI‑профилей (если используются)
- `prompts/<agent>/config.json`: реестр вариантов промптов агента
- `prompts/<agent>/variants/*.md`: содержимое промптов/инструкций
- `tools/`: глобальные описания групп и инструментов
- `context/`: конфигурация систем автоконтекста

## Важные механики
- Дефолт формируется только распаковкой `assets/agicoder-seed.zip` при первой активации расширения. Фолбэков/программной автогенерации нет.
- Список режимов (MODES) и список доступных агентов в системном промпте фильтруются по `visibleAgents` текущего агента.
- Делегирование на скрытых агентов блокируется логикой инструмента `new_task`.
- Инструменты в рантайме разрешаются строго по `toolBindings` из `agent.json`.

## Новый инструмент оркестратора: agent_inspect
Read‑only просмотр конфигурации другого агента, с опциональной дешёвой суммаризацией техстека и ограничений.

Пример вызова:
```xml
<agent_inspect>
  <agent_slug>ui-engineer</agent_slug>
  <summarize>true</summarize>
  <provider>openrouter</provider>
  <model>openai/gpt-4o-mini</model>
  <max_chars>1000</max_chars>
</agent_inspect>
```

Профиль по умолчанию можно задать в текущем агенте (например, `orchestrator`):
```jsonc
"toolBindings": {
  "customConfiguration": {
    "toolProfiles": {
      "agent_inspect": {
        "provider": "openrouter",
        "model": "openai/gpt-4o-mini",
        "summarize": true
      }
    }
  }
}
```

## Рекомендации
- Поддерживайте `visibleAgents` в актуальном состоянии — это влияет на список доступных делегатов и на моды в системном промпте.
- Выносите «стек» конкретных исполнителей в их промпты (`variants/*.md`), чтобы оркестратор мог быстро получить суммаризацию через `agent_inspect` без высоких затрат токенов (включите профиль дешёвой модели).
